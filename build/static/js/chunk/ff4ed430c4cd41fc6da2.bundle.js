(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{RuOE:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("q1tI");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var firebase_app__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("Wcq6");\n/* harmony import */ var firebase_app__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(firebase_app__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("WlAH");\n/* harmony import */ var _tools__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("Ueoi");\n\n\n\n\n\nfunction index() {\n  var _useContext = Object(react__WEBPACK_IMPORTED_MODULE_0__["useContext"])(_tools__WEBPACK_IMPORTED_MODULE_3__[/* IContext */ "c"]),\n      me = _useContext.me,\n      history = _useContext.history;\n\n  var remoteVideo = Object(react__WEBPACK_IMPORTED_MODULE_0__["useRef"])();\n  var idSeminar = \'1\';\n  var idUser = me === null || me === void 0 ? void 0 : me._id;\n  Object(react__WEBPACK_IMPORTED_MODULE_0__["useEffect"])(function () {\n    var pc = new RTCPeerConnection(_constants__WEBPACK_IMPORTED_MODULE_2__[/* configRTCPeerConnection */ "a"]);\n\n    pc.ontrack = function (e) {\n      remoteVideo.current.srcObject = new MediaStream(e.streams[0]);\n    };\n\n    firebase_app__WEBPACK_IMPORTED_MODULE_1__["database"]().ref("seminars/".concat(idSeminar, "/participants/").concat(idUser, "/candidate")).on(\'value\', function (snap) {\n      var candidate = JSON.parse(snap.val());\n\n      if (candidate) {\n        pc.addIceCandidate(new RTCIceCandidate(candidate));\n      }\n    });\n    firebase_app__WEBPACK_IMPORTED_MODULE_1__["database"]().ref("seminars/".concat(idSeminar, "/isStart")).on(\'value\', function (snapshot) {\n      if (!snapshot.val()) {\n        firebase_app__WEBPACK_IMPORTED_MODULE_1__["database"]().ref("seminars/".concat(idSeminar, "/isStart")).off();\n        firebase_app__WEBPACK_IMPORTED_MODULE_1__["database"]().ref("seminars/".concat(idSeminar, "/participants/").concat(idUser)).remove();\n        pc.close();\n        history.push(\'/ket-thuc\');\n      } else {\n        if (idUser) {\n          pc.createOffer({\n            offerToReceiveAudio: true,\n            offerToReceiveVideo: true\n          }).then(function (sdp) {\n            pc.setLocalDescription(sdp);\n            firebase_app__WEBPACK_IMPORTED_MODULE_1__["database"]().ref("seminars/".concat(idSeminar, "/participants/").concat(idUser)).set({\n              _id: me === null || me === void 0 ? void 0 : me._id,\n              fullName: "".concat(me === null || me === void 0 ? void 0 : me.firstname, " ").concat(me === null || me === void 0 ? void 0 : me.lastname),\n              offer: JSON.stringify(sdp)\n            });\n          })["catch"](function (err) {\n            return console.log(err);\n          });\n          firebase_app__WEBPACK_IMPORTED_MODULE_1__["database"]().ref("seminars/".concat(idSeminar, "/participants/").concat(idUser, "/answer")).on(\'value\', function (snapshot) {\n            var answerSdp = JSON.parse(snapshot.val());\n\n            if (answerSdp) {\n              pc.setRemoteDescription(new RTCSessionDescription(answerSdp));\n            }\n          });\n        }\n      }\n    });\n    firebase_app__WEBPACK_IMPORTED_MODULE_1__["database"]().ref("seminars/".concat(idSeminar, "/participants/").concat(idUser)).onDisconnect().remove();\n  }, []);\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("div", {\n    style: {\n      padding: 50\n    }\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement("video", {\n    ref: remoteVideo,\n    autoPlay: true,\n    playsInline: true,\n    style: {\n      width: 360,\n      height: 240,\n      background: \'#000\'\n    }\n  }));\n}\n\n/* harmony default export */ __webpack_exports__["default"] = (index);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUnVPRS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9wYWdlcy9qb2luU2VtaW5hci9pbmRleC5qcz80NmUzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyB1c2VSZWYsIHVzZUVmZmVjdCwgdXNlQ29udGV4dCB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0ICogYXMgZmlyZWJhc2UgZnJvbSAnZmlyZWJhc2UvYXBwJ1xuaW1wb3J0IHsgY29uZmlnUlRDUGVlckNvbm5lY3Rpb24gfSBmcm9tICdAY29uc3RhbnRzJ1xuaW1wb3J0IHsgSUNvbnRleHQgfSBmcm9tICdAdG9vbHMnXG5cbmZ1bmN0aW9uIGluZGV4KCkge1xuICBjb25zdCB7IG1lLCBoaXN0b3J5IH0gPSB1c2VDb250ZXh0KElDb250ZXh0KVxuICBjb25zdCByZW1vdGVWaWRlbyA9IHVzZVJlZigpXG4gIGNvbnN0IGlkU2VtaW5hciA9ICcxJ1xuICBjb25zdCBpZFVzZXIgPSBtZT8uX2lkXG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBwYyA9IG5ldyBSVENQZWVyQ29ubmVjdGlvbihjb25maWdSVENQZWVyQ29ubmVjdGlvbilcblxuICAgIHBjLm9udHJhY2sgPSBlID0+IHtcbiAgICAgIHJlbW90ZVZpZGVvLmN1cnJlbnQuc3JjT2JqZWN0ID0gbmV3IE1lZGlhU3RyZWFtKGUuc3RyZWFtc1swXSlcbiAgICB9XG5cbiAgICBmaXJlYmFzZVxuICAgICAgLmRhdGFiYXNlKClcbiAgICAgIC5yZWYoYHNlbWluYXJzLyR7aWRTZW1pbmFyfS9wYXJ0aWNpcGFudHMvJHtpZFVzZXJ9L2NhbmRpZGF0ZWApXG4gICAgICAub24oJ3ZhbHVlJywgc25hcCA9PiB7XG4gICAgICAgIGNvbnN0IGNhbmRpZGF0ZSA9IEpTT04ucGFyc2Uoc25hcC52YWwoKSlcbiAgICAgICAgaWYgKGNhbmRpZGF0ZSkge1xuICAgICAgICAgIHBjLmFkZEljZUNhbmRpZGF0ZShuZXcgUlRDSWNlQ2FuZGlkYXRlKGNhbmRpZGF0ZSkpXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICBmaXJlYmFzZVxuICAgICAgLmRhdGFiYXNlKClcbiAgICAgIC5yZWYoYHNlbWluYXJzLyR7aWRTZW1pbmFyfS9pc1N0YXJ0YClcbiAgICAgIC5vbigndmFsdWUnLCBzbmFwc2hvdCA9PiB7XG4gICAgICAgIGlmICghc25hcHNob3QudmFsKCkpIHtcbiAgICAgICAgICBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZihgc2VtaW5hcnMvJHtpZFNlbWluYXJ9L2lzU3RhcnRgKS5vZmYoKVxuICAgICAgICAgIGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKGBzZW1pbmFycy8ke2lkU2VtaW5hcn0vcGFydGljaXBhbnRzLyR7aWRVc2VyfWApLnJlbW92ZSgpXG4gICAgICAgICAgcGMuY2xvc2UoKVxuICAgICAgICAgIGhpc3RvcnkucHVzaCgnL2tldC10aHVjJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZiAoaWRVc2VyKSB7XG4gICAgICAgICAgICBwYy5jcmVhdGVPZmZlcih7XG4gICAgICAgICAgICAgIG9mZmVyVG9SZWNlaXZlQXVkaW86IHRydWUsXG4gICAgICAgICAgICAgIG9mZmVyVG9SZWNlaXZlVmlkZW86IHRydWVcbiAgICAgICAgICAgIH0pLnRoZW4oc2RwID0+IHtcbiAgICAgICAgICAgICAgcGMuc2V0TG9jYWxEZXNjcmlwdGlvbihzZHApXG4gICAgICAgICAgICAgIGZpcmViYXNlXG4gICAgICAgICAgICAgICAgLmRhdGFiYXNlKClcbiAgICAgICAgICAgICAgICAucmVmKGBzZW1pbmFycy8ke2lkU2VtaW5hcn0vcGFydGljaXBhbnRzLyR7aWRVc2VyfWApXG4gICAgICAgICAgICAgICAgLnNldCh7XG4gICAgICAgICAgICAgICAgICBfaWQ6IG1lPy5faWQsXG4gICAgICAgICAgICAgICAgICBmdWxsTmFtZTogYCR7bWU/LmZpcnN0bmFtZX0gJHttZT8ubGFzdG5hbWV9YCxcbiAgICAgICAgICAgICAgICAgIG9mZmVyOiBKU09OLnN0cmluZ2lmeShzZHApXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH0pLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKVxuICAgICAgICAgICAgZmlyZWJhc2VcbiAgICAgICAgICAgICAgLmRhdGFiYXNlKClcbiAgICAgICAgICAgICAgLnJlZihgc2VtaW5hcnMvJHtpZFNlbWluYXJ9L3BhcnRpY2lwYW50cy8ke2lkVXNlcn0vYW5zd2VyYClcbiAgICAgICAgICAgICAgLm9uKCd2YWx1ZScsIHNuYXBzaG90ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBhbnN3ZXJTZHAgPSBKU09OLnBhcnNlKHNuYXBzaG90LnZhbCgpKVxuICAgICAgICAgICAgICAgIGlmIChhbnN3ZXJTZHApIHtcbiAgICAgICAgICAgICAgICAgIHBjLnNldFJlbW90ZURlc2NyaXB0aW9uKG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24oYW5zd2VyU2RwKSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIGZpcmViYXNlXG4gICAgICAuZGF0YWJhc2UoKVxuICAgICAgLnJlZihgc2VtaW5hcnMvJHtpZFNlbWluYXJ9L3BhcnRpY2lwYW50cy8ke2lkVXNlcn1gKVxuICAgICAgLm9uRGlzY29ubmVjdCgpXG4gICAgICAucmVtb3ZlKClcbiAgfSwgW10pXG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2IHN0eWxlPXt7IHBhZGRpbmc6IDUwIH19PlxuICAgICAgPHZpZGVvXG4gICAgICAgIHJlZj17cmVtb3RlVmlkZW99XG4gICAgICAgIGF1dG9QbGF5XG4gICAgICAgIHBsYXlzSW5saW5lXG4gICAgICAgIHN0eWxlPXt7IHdpZHRoOiAzNjAsIGhlaWdodDogMjQwLCBiYWNrZ3JvdW5kOiAnIzAwMCcgfX1cbiAgICAgIC8+XG4gICAgPC9kaXY+XG4gIClcbn1cblxuZXhwb3J0IGRlZmF1bHQgaW5kZXhcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUFBO0FBQUE7QUFDQTtBQUlBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUpBO0FBUUE7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///RuOE\n')},WlAH:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "a", function() { return configRTCPeerConnection; });\nvar configRTCPeerConnection = {\n  iceServers: [{\n    urls: \'stun:stun.l.google.com:19302\'\n  }, {\n    urls: "<YOUR_TURN_SERVER_URI>",\n    credential: "<YOUR_TURN_SERVER_PASSWORD>",\n    username: "<YOUR_TURN_SERVER_USERNAME>"\n  }]\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV2xBSC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9jb25zdGFudHMvaW5kZXguanM/NWE1MCJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgY29uZmlnUlRDUGVlckNvbm5lY3Rpb24gPSB7XG4gIGljZVNlcnZlcnM6IFtcbiAgICB7XG4gICAgICB1cmxzOiAnc3R1bjpzdHVuLmwuZ29vZ2xlLmNvbToxOTMwMidcbiAgICB9LFxuICAgIHtcbiAgICAgIHVybHM6IHByb2Nlc3MuZW52LlRVUk5fU0VSVkVSLFxuICAgICAgY3JlZGVudGlhbDogcHJvY2Vzcy5lbnYuVFVSTl9QQVNTV09SRCxcbiAgICAgIHVzZXJuYW1lOiBwcm9jZXNzLmVudi5UVVJOX1VTRVJOQU1FXG4gICAgfVxuICBdXG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFDQTtBQUVBO0FBREE7QUFJQTtBQUNBO0FBQ0E7QUFIQTtBQUxBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///WlAH\n')}}]);